<template>
    <div id="layout-config" :class="containerClass">
        <a
            href="#"
            class="layout-config-button"
            id="layout-config-button"
            @click="toggleConfigurator"
        >
            <i class="pi pi-user"></i>
        </a>
        <div class="grid layout-config-content">
            <div class="col-12">
                <h4>Contacts</h4>
                <Button type="button" icon="pi pi-search" />
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
            <div class="col-12">
                <Button label="Primary" class="p-button-text">
                    <Avatar
                        image="https://www.primefaces.org/wp-content/uploads/2020/05/placeholder.png"
                        class="mr-2"
                        size="xlarge"
                        shape="circle"
                    />
                    <p class="m-0 p-0">Joshua Henry G. Diamos</p>
                </Button>
                <div class="p-inputgroup mb-2"></div>
            </div>
        </div>
    </div>
</template>

<script>
export default {
    props: {
        layoutMode: {
            type: String,
            default: null,
        },
        layoutColorMode: {
            type: String,
            default: null,
        },
    },
    data() {
        return {
            active: false,
            d_layoutMode: this.layoutMode,
            d_layoutColorMode: this.layoutColorMode,
            scale: 16,
            scales: [12, 13, 14, 15, 16],
        };
    },
    watch: {
        $route() {
            if (this.active) {
                this.active = false;
                this.unbindOutsideClickListener();
            }
        },
        layoutMode(newValue) {
            this.d_layoutMode = newValue;
        },
        layoutColorMode(newValue) {
            this.d_layoutColorMode = newValue;
        },
    },
    outsideClickListener: null,
    methods: {
        toggleConfigurator(event) {
            this.active = !this.active;
            event.preventDefault();

            if (this.active) this.bindOutsideClickListener();
            else this.unbindOutsideClickListener();
        },
        hideConfigurator(event) {
            this.active = false;
            this.unbindOutsideClickListener();
            event.preventDefault();
        },
        changeInputStyle(value) {
            this.$primevue.config.inputStyle = value;
        },
        changeRipple(value) {
            this.$primevue.config.ripple = value;
        },
        changeLayout(event, layoutMode) {
            this.$emit("layout-change", layoutMode);
            event.preventDefault();
        },
        changeLayoutColor(event, layoutColor) {
            this.$emit("layout-color-change", layoutColor);
            event.preventDefault();
        },
        bindOutsideClickListener() {
            if (!this.outsideClickListener) {
                this.outsideClickListener = (event) => {
                    if (this.active && this.isOutsideClicked(event)) {
                        this.active = false;
                    }
                };
                document.addEventListener("click", this.outsideClickListener);
            }
        },
        unbindOutsideClickListener() {
            if (this.outsideClickListener) {
                document.removeEventListener(
                    "click",
                    this.outsideClickListener
                );
                this.outsideClickListener = null;
            }
        },
        isOutsideClicked(event) {
            return !(
                this.$el.isSameNode(event.target) ||
                this.$el.contains(event.target)
            );
        },
        decrementScale() {
            this.scale--;
            this.applyScale();
        },
        incrementScale() {
            this.scale++;
            this.applyScale();
        },
        applyScale() {
            document.documentElement.style.fontSize = this.scale + "px";
        },
        changeTheme(event, theme, dark = false) {
            let themeElement = document.getElementById("theme-link");
            themeElement.setAttribute(
                "href",
                themeElement
                    .getAttribute("href")
                    .replace(this.$appState.theme, theme)
            );
            this.$appState.theme = theme;
            this.$appState.darkTheme = dark;

            if (theme.startsWith("md")) {
                this.$primevue.config.ripple = true;
            }
        },
    },
    computed: {
        containerClass() {
            return ["layout-config", { "layout-config-active": this.active }];
        },
        rippleActive() {
            return this.$primevue.config.ripple;
        },
        inputStyle() {
            return this.$appState.inputStyle;
        },
    },
};
</script>
